<html>

<head>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>ÈØäÂÆúÁöÑÊ°åÁêÉ‰πãË∑Ø</title>
    <link rel="manifest" href="./manifest.webmanifest">
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"
        integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/mobile/1.5.0-rc1/jquery.mobile-1.5.0-rc1.min.js"></script>
</head>

<body>
    <style>
        html {
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            -khtml-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }

        body {
            margin: 0;
            width: 100%;
            min-height: 100dvh;
        }

        .container {
            padding: 20px;
        }

        .main {
            margin-top: 40px;
        }

        .progress-container {
            width: 100%;
            height: 16px;
            background-color: #ccc;
            border-radius: 15px;
            box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.2);
        }

        .item+.item {
            margin-top: 10px;
        }

        .progress-bar {
            border-radius: 15px;
            position: relative;
            height: 100%;
            width: 0%;
            transition: width 0.5s ease-in-out;
            background-size: 100% 100%;
        }

        .progress-bar.score1 {
            background: #ff4d4f;
        }

        .progress-bar.score1::after {
            color: #fff;
        }

        .progress-bar.score2 {
            background: #faad14;
        }

        .progress-bar.score2::after {
            color: #fff;
        }

        .progress-bar.score3 {
            background: #40a9ff;
        }

        .progress-bar.score3::after {
            color: #fff;
        }

        .progress-bar.score4 {
            background: #52c41a;
        }

        .progress-bar.score4::after {
            color: #fff;
        }

        .progress-bar::after {
            display: block;
            position: absolute;
            /* left: calc(100% - 40px); */
            right: 6px;
            top: 0px;
            font-size: 16px;
            font-weight: bold;
            line-height: 16px;
            content: attr(data-score)"%";

        }

        .item__title {
            font-size: 16px;
        }

        .select-container {
            display: flex;
            justify-content: flex-end;
            position: fixed;
            top: 0px;
            right: 0px;
            width: 100%;
            background: #ffffffcc;
            padding-top: 20px;
            padding-right: 20px;
            z-index: 1;
        }

        .view-select {
            font-size: 16px;
            border: 1px solid;
            padding: 10px;
        }

        .ui-selectmenu-button-text {
            display: none;
        }

        .ui-loader-header {
            display: none;
        }
    </style>

    <div class="container">
        <div class="select-container">
            <select name="È°ØÁ§∫Ê®°Âºè" id="view-select" class="view-select">
                <option value="È†êË®≠" selected>È†êË®≠</option>
                <option value="ÁÜüÁ∑¥Â∫¶Áî±‰ΩéÂà∞È´ò">ÁÜüÁ∑¥Â∫¶ Áî±‰ΩéÂà∞È´ò</option>
                <option value="ÁÜüÁ∑¥Â∫¶Áî±È´òÂà∞‰Ωé">ÁÜüÁ∑¥Â∫¶ Áî±È´òÂà∞‰Ωé</option>
            </select>
        </div>
        <div class="main" id="main">
        </div>
    </div>

    <script>
        var dataList = getDataList() ?? [];
        dataList = [...dataList]
            .sort((a, b) => a.originOrder - b.originOrder)
            .map(x => ({ ...x, id: "d" + x.originOrder }));

        // var dataList = [
        //     { id: "d1", name: '123', score: 20 },
        //     { id: "d2", name: '456', score: 60 },
        //     { id: "d3", name: '123', score: 20 },
        //     { id: "d4", name: '456', score: 80 }
        // ];

        renderData(dataList);

        document.getElementById("view-select").addEventListener("change", function () {
            console.log(this.value);
            const chooseValue = this.value;
            if ("È†êË®≠" === chooseValue) {
                renderData(dataList);
            }
            if ("ÁÜüÁ∑¥Â∫¶Áî±‰ΩéÂà∞È´ò" === chooseValue) {
                renderData([...dataList].sort((a, b) => a.score - b.score));
            }
            if ("ÁÜüÁ∑¥Â∫¶Áî±È´òÂà∞‰Ωé" === chooseValue) {
                renderData([...dataList].sort((a, b) => b.score - a.score));
            }
        })

        function renderData(dataList) {
            const main = document.getElementById("main");
            main.innerHTML = "";

            dataList.forEach(data => {
                var classNameForStyle = getProgressBarClassName(data.score);
                var item = document.createElement("div");
                item.className = "item";
                item.innerHTML = `
            <div class="item__title">${data.name}</div>
            <div class="progress-container">
                <div id="${data.id}" class="progress-bar ${classNameForStyle}" data-name="${data.name}" data-score="${data.score}" data-origin-order="${data.originOrder}"></div>
            </div>
            `;

                main.append(item);
                // document.getElementById(data.id).style.width = data.score + "%";
                // progressBar.getElementsByClassName("progress-bar")[0].width = "30%";
            });

            setTimeout(function () {
                dataList.forEach(data => {
                    document.getElementById(data.id).style.width = data.score + "%";
                });
            }, 10);
        }

        // ‰ΩøÁî®Á¶ÆÁâ© action
        $(".main").on("taphold", ".progress-container", function (event) {

            var target = $(event.currentTarget);
            var targetProgressBar = target.find(".progress-bar[data-score]");
            var score = window.prompt("Ë´ãËº∏ÂÖ•ÂàÜÊï∏", targetProgressBar.attr("data-score"));
            if (score) {
                targetProgressBar.css("width", score + "%");
                targetProgressBar.attr("data-score", score);
                targetProgressBar.removeClass("score1 score2 score3 score4").addClass(getProgressBarClassName(score));

                // Â∞áË≥áÊñôÂ°ûÂõû localstorage
                var resultDataList = $(".progress-bar").toArray().map(ele => ({
                    name: $(ele).attr("data-name"),
                    score: Number($(ele).attr("data-score")),
                    originOrder: Number($(ele).attr("data-origin-order"))
                }));
                window.localStorage.setItem("dataList", JSON.stringify(resultDataList));
            }
        });

        function getDataList() {
            window.localStorage.removeItem("dataList");
            var dataList = window.localStorage.getItem("dataList");
            if (dataList === null) {
                dataList = [
                    { name: "üå± Âü∫Á§é-Ê≠£ÊâãÂ∞çÊâì", score: 75, originOrder: 0 },
                    { name: "üå± Âü∫Á§é-Ê≠£ÊâãÂàáÁêÉ", score: 35, originOrder: 1 },
                    { name: "üå± Âü∫Á§é-ÂèçÊâãÂ∞çÊâì", score: 75, originOrder: 2 },
                    { name: "üå± Âü∫Á§é-ÂèçÊâãÂàáÁêÉ", score: 20, originOrder: 3 },

                    { name: "‚öîÔ∏è ÊîªÊìä-Ê≠£ÊâãÂπ≥Êãâ", score: 35, originOrder: 4 },
                    { name: "‚öîÔ∏è ÊîªÊìä-Ê≠£Êâã‰∏ãÊóãÊãâ", score: 55, originOrder: 5 },
                    { name: "‚öîÔ∏è ÊîªÊìä-Ê≠£ÊâãÊÆ∫ÁêÉ(È´òÁêÉÂπ≥ÁêÉ)", score: 55, originOrder: 6 },
                    { name: "‚öîÔ∏è ÊîªÊìä-Ê≠£ÊâãÊÆ∫ÁêÉ(‰∏ÄËà¨È´òÂ∫¶Âπ≥ÁêÉ)", score: 55, originOrder: 7 },
                    { name: "‚öîÔ∏è ÊîªÊìä-Ê≠£ÊâãÊÆ∫ÁêÉ(È´òÁêÉ‰∏ãÊóã)", score: 55, originOrder: 8 },
                    { name: "‚öîÔ∏è ÊîªÊìä-Ê≠£ÊâãÊåëÁêÉ", score: 55, originOrder: 9 },
                    { name: "‚öîÔ∏è ÊîªÊìä-Ê≠£ÊâãÂàáÁêÉÂäàÈï∑", score: 55, originOrder: 10 },
                    { name: "‚öîÔ∏è ÊîªÊìä-Ê≠£ÊâãÊíáÁõ¥Á∑öÈï∑ÁêÉ", score: 55, originOrder: 11 },
                    { name: "‚öîÔ∏è ÊîªÊìä-ÂèçÊâãÂπ≥Êãâ", score: 35, originOrder: 12 },
                    { name: "‚öîÔ∏è ÊîªÊìä-ÂèçÊâã‰∏ãÊóãÊãâ", score: 55, originOrder: 13 },
                    { name: "‚öîÔ∏è ÊîªÊìä-ÂèçÊâãÊÆ∫ÁêÉ(È´òÁêÉÂπ≥ÁêÉ)", score: 55, originOrder: 14 },
                    { name: "‚öîÔ∏è ÊîªÊìä-ÂèçÊâãÊÆ∫ÁêÉ(‰∏ÄËà¨È´òÂ∫¶Âπ≥ÁêÉ)", score: 55, originOrder: 15 },
                    { name: "‚öîÔ∏è ÊîªÊìä-ÂèçÊâãÊÆ∫ÁêÉ(È´òÁêÉ‰∏ãÊóã)", score: 55, originOrder: 16 },
                    { name: "‚öîÔ∏è ÊîªÊìä-ÂèçÊâãÊåëÁêÉ", score: 55, originOrder: 17 },
                    { name: "‚öîÔ∏è ÊîªÊìä-ÂèçÊâãÂàáÁêÉÂäàÈï∑", score: 55, originOrder: 18 },
                    { name: "‚öîÔ∏è ÊîªÊìä-ÂèçÊâãÊì∞ÁêÉ", score: 55, originOrder: 19 },

                    { name: "üõ°Ô∏è Èò≤ÂÆà-Ê≠£ÊâãÂàáÁêÉÊì∫Áü≠", score: 55, originOrder: 20 },
                    { name: "üõ°Ô∏è Èò≤ÂÆà-Ê≠£ÊâãÊìãÊãâÁêÉ(‰∏ÄËà¨È´òÂ∫¶)", score: 55, originOrder: 21 },
                    { name: "üõ°Ô∏è Èò≤ÂÆà-Ê≠£ÊâãÊìãÊãâÁêÉ(ÂçäÈ´ò)", score: 55, originOrder: 22 },
                    { name: "üõ°Ô∏è Èò≤ÂÆà-Ê≠£ÊâãÊìãÊÆ∫ÁêÉ", score: 55, originOrder: 23 },
                    { name: "üõ°Ô∏è Èò≤ÂÆà-ÂèçÊâãÊìãÊãâÁêÉ(‰∏ÄËà¨È´òÂ∫¶)", score: 55, originOrder: 24 },
                    { name: "üõ°Ô∏è Èò≤ÂÆà-ÂèçÊâãÂàáÁêÉÊì∫Áü≠", score: 55, originOrder: 25 },
                    { name: "üõ°Ô∏è Èò≤ÂÆà-ÂèçÊâãÊìãÊãâÁêÉ(ÂçäÈ´ò)", score: 55, originOrder: 26 },
                    { name: "üõ°Ô∏è Èò≤ÂÆà-ÂèçÊâãÊìãÊÆ∫ÁêÉ", score: 55, originOrder: 27 },
                    { name: "üõ°Ô∏è Èò≤ÂÆà-ÂèçÊâãÂÅ¥Âàá", score: 55, originOrder: 28 },

                    { name: "üëü ËÖ≥Ê≠•&ÈäúÊé•-Âõ∫ÂÆöÂÖ©Èªû(Ê≠£Âèç)", score: 55, originOrder: 29 },
                    { name: "üëü ËÖ≥Ê≠•&ÈäúÊé•-Âõ∫ÂÆö‰∏âÈªû(Ê≠£ÂèçÂÅ¥Ë∫´)", score: 55, originOrder: 30 },
                    { name: "üëü ËÖ≥Ê≠•&ÈäúÊé•-‰∏çÂÆöÈªû(Ê≠£Âèç)", score: 55, originOrder: 31 },
                    { name: "üëü ËÖ≥Ê≠•&ÈäúÊé•-‰∏çÂÆöÈªû(ÂÖ®Âè∞)", score: 55, originOrder: 32 },
                    { name: "üëü ËÖ≥Ê≠•&ÈäúÊé•-Ê≠£Êâã‰ΩçÊé•ÁêÉ(Èï∑ÁêÉ->ÊÆ∫ÁêÉÊàñÊãâÁêÉÔºåÁü≠ÁêÉ->ÂàáÁêÉ)", score: 55, originOrder: 33 },
                    { name: "üëü ËÖ≥Ê≠•&ÈäúÊé•-ÂèçÊâã‰ΩçÊé•ÁêÉ(Èï∑ÁêÉ->ÊÆ∫ÁêÉÊàñÊãâÁêÉÔºåÁü≠ÁêÉ->ÂàáÁêÉ)", score: 55, originOrder: 34 },

                    { name: "‚ñ∂Ô∏è ÁôºÁêÉ-ÁôºÂ∑¶Êóã/Âè≥Êóã+‰∏äÊóã/‰∏ãÊóã+Èï∑ÁêÉ/Áü≠ÁêÉ+Áü≠Á©∫+Âø´ÈÄüÁêÉ", score: 55, originOrder: 35 },

                    { name: "üîç Êé•ÁêÉ-Êé•Â∑¶Êóã/Âè≥Êóã+‰∏äÊóã/‰∏ãÊóã+Èï∑ÁêÉ/Áü≠ÁêÉ+Áü≠Á©∫+Âø´ÈÄüÁêÉÔºå‰∏¶ËÉΩÂ§†‰ΩøÁî®ÈÄÜÊóãËΩâ/È†ÜÊóãËΩâÊé•ÁêÉ", score: 55, originOrder: 36 },

                    { name: "ü•ã Âª∫Á´ãËá™Â∑±ÁöÑÁ≠ñÁï•-ÁôºÁü≠Á©∫->ÊÆ∫ÁêÉ", score: 55, originOrder: 37 }
                ];
                window.localStorage.setItem("dataList", JSON.stringify(dataList));
            } else {
                dataList = JSON.parse(dataList);
            }

            return dataList;
        }

        function getProgressBarClassName(score) {
            var classNameForStyle = "";
            if (score <= 25) {
                classNameForStyle = "score1";
            }
            else if (score <= 50) {
                classNameForStyle = "score2";
            }
            else if (score <= 75) {
                classNameForStyle = "score3";
            }
            else if (score <= 100) {
                classNameForStyle = "score4";
            }
            return classNameForStyle;
        }
    </script>
</body>



</html>